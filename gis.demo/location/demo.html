<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <title>Demo for Data on Map</title>
    <style>
        body, html {
            width: 100%;
            height: 100%;
        }

        * {
            margin: 0px;
            padding: 0px;
        }

        body, button, input, select, textarea {
            font: 12px/16px Verdana, Helvetica, Arial, sans-serif;
        }
    </style>
    <script charset="utf-8" src="http://map.qq.com/api/js?v=2.exp"></script>
    <script src="http://open.map.qq.com/apifiles/plugins/heatmap/heatmap.min.js"></script>
</head>
<body>

<div class="heatmap" style="width:100%;height:100%" id="map-canvas">

</div>
<script>

    window.onload = function () {
    	var center = new qq.maps.LatLng(38.497559, 106.107883);
//    	var center = new qq.maps.LatLng(39.921984, 116.418261);
    
        map = new qq.maps.Map(document.getElementById("map-canvas"), {
            zoom: 14,
            center: center
        });
        
        setTimeout(function(){
	        var marker=new qq.maps.Marker({
	            position:center,
				animation:qq.maps.MarkerAnimation.DROP,
	            map:map
	        });
	        //marker.setAnimation(qq.maps.Animation.DROP);
    	},2000);
    	
	    var circle=new qq.maps.Circle({
	        map:map,
	        center: center,
	        radius: 3000,
	        strokeWeight: 1
	    });

        //async load 
        qq.maps.event.addListenerOnce(map, "idle", function () {
            if (QQMapPlugin.isSupportCanvas) {
                heatmap = new QQMapPlugin.HeatmapOverlay(map,
                        {
                        	// dot radius
                            "radius": 1,
                            //热力图最大透明度
                            "maxOpacity": 0.8,
                            //是否在每一屏都开启重新计算，如果为true则每一屏都会有一个红点
                            "useLocalExtrema": true,
                            //设置大小字段
                            "valueField": 'count'
                        }
                );
                
                testData = {
                    max: 100,
                    data: [
                        {"lng": 106.118261, "lat": 38.481984, "count": 50},
                        {"lng": 106.123332, "lat": 38.476532, "count": 51},
                        {"lng": 106.119787, "lat": 38.490658, "count": 15},
                        {"lng": 106.118455, "lat": 38.480921, "count": 40},
                        {"lng": 106.118843, "lat": 38.475516, "count": 100},
                        {"lng": 106.125462, "lat": 38.478503, "count": 6},
                        {"lng": 106.123289, "lat": 38.479989, "count": 18},
                        {"lng": 106.118162, "lat": 38.475051, "count": 80},
                        {"lng": 106.122039, "lat": 38.477822, "count": 11},
                        {"lng": 106.113287, "lat": 38.477253, "count": 7},
                        {"lng": 106.117273, "lat": 38.479426, "count": 42},
                        {"lng": 106.121107, "lat": 38.476445, "count": 4},
                        {"lng": 106.117521, "lat": 38.477943, "count": 27},
                        {"lng": 106.119812, "lat": 38.480836, "count": 23},
                        {"lng": 106.120682, "lat": 38.474632, "count": 60},
                        {"lng": 106.115424, "lat": 38.484675, "count": 8},
                        {"lng": 106.119242, "lat": 38.474509, "count": 15},
                        {"lng": 106.122766, "lat": 38.481408, "count": 25},
                        {"lng": 106.121674, "lat": 38.484396, "count": 21},
                        {"lng": 106.127268, "lat": 38.482672, "count": 1},
                        {"lng": 106.117221, "lat": 38.480034, "count": 51},
                        {"lng": 106.114526, "lat": 38.486672, "count": 7},
                        {"lng": 106.120432, "lat": 38.479114, "count": 11},
                        {"lng": 106.125013, "lat": 38.481611, "count": 35},
                        {"lng": 106.118733, "lat": 38.491037, "count": 22},
                        {"lng": 106.119336, "lat": 38.491134, "count": 4},
                        {"lng": 106.113557, "lat": 38.483254, "count": 5},
                        {"lng": 106.118367, "lat": 38.489431, "count": 3},
                        {"lng": 106.124312, "lat": 38.479621, "count": 100},
                        {"lng": 106.123874, "lat": 38.479447, "count": 87},
                        {"lng": 106.124225, "lat": 38.483091, "count": 32},
                        {"lng": 106.117801, "lat": 38.481854, "count": 44},
                        {"lng": 106.117129, "lat": 38.488227, "count": 21},
                        {"lng": 106.126426, "lat": 38.482286, "count": 80},
                        {"lng": 106.121597, "lat": 38.479482, "count": 32},
                        {"lng": 106.123895, "lat": 38.480787, "count": 26},
                        {"lng": 106.123563, "lat": 38.481197, "count": 17},
                        {"lng": 106.117982, "lat": 38.482547, "count": 17},
                        {"lng": 106.126126, "lat": 38.481938, "count": 25},
                        {"lng": 106.123216, "lat": 38.475782, "count": 100},
                        {"lng": 106.119239, "lat": 38.476759, "count": 39},
                        {"lng": 106.117185, "lat": 38.489123, "count": 11},
                        {"lng": 106.117237, "lat": 38.487518, "count": 9},
                        {"lng": 106.117784, "lat": 38.475754, "count": 47},
                        {"lng": 106.120193, "lat": 38.477061, "count": 52},
                        {"lng": 106.122735, "lat": 38.475619, "count": 100},
                        {"lng": 106.118495, "lat": 38.475958, "count": 46},
                        {"lng": 106.116292, "lat": 38.491166, "count": 9},
                        {"lng": 106.119916, "lat": 38.484055, "count": 8},
                        {"lng": 106.121892, "lat": 38.481308, "count": 11},
                        {"lng": 106.113765, "lat": 38.489376, "count": 3},
                        {"lng": 106.118232, "lat": 38.480348, "count": 50},
                        {"lng": 106.117554, "lat": 38.490511, "count": 15},
                        {"lng": 106.118568, "lat": 38.478161, "count": 23},
                        {"lng": 106.113461, "lat": 38.486306, "count": 3},
                        {"lng": 106.122322, "lat": 38.481612, "count": 13},
                        {"lng": 106.117422, "lat": 38.488616, "count": 6},
                        {"lng": 106.124679, "lat": 38.475499, "count": 21},
                        {"lng": 106.121712, "lat": 38.475738, "count": 29},
                        {"lng": 106.117836, "lat": 38.476998, "count": 99},
                        {"lng": 106.120755, "lat": 38.488001, "count": 10},
                        {"lng": 106.114077, "lat": 38.490655, "count": 14},
                        {"lng": 106.126092, "lat": 38.482995, "count": 16},
                        {"lng": 106.115352, "lat": 38.491054, "count": 15},
                        {"lng": 106.113022, "lat": 38.481895, "count": 13},
                        {"lng": 106.115551, "lat": 38.473373, "count": 17},
                        {"lng": 106.121191, "lat": 38.486572, "count": 1},
                        {"lng": 106.119612, "lat": 38.477119, "count": 9},
                        {"lng": 106.118237, "lat": 38.481337, "count": 54},
                        {"lng": 106.123776, "lat": 38.481919, "count": 26},
                        {"lng": 106.117694, "lat": 38.485362, "count": 17},
                        {"lng": 106.115377, "lat": 38.474137, "count": 19},
                        {"lng": 106.117434, "lat": 38.474394, "count": 43},
                        {"lng": 106.125828, "lat": 38.482622, "count": 27},
                        {"lng": 106.118345, "lat": 38.479467, "count": 8},
                        {"lng": 106.126883, "lat": 38.477171, "count": 3},
                        {"lng": 106.123877, "lat": 38.476659, "count": 34},
                        {"lng": 106.115712, "lat": 38.475613, "count": 14},
                        {"lng": 106.119869, "lat": 38.491416, "count": 12},
                        {"lng": 106.116956, "lat": 38.485377, "count": 11},
                        {"lng": 106.120662, "lat": 38.485017, "count": 38},
                        {"lng": 106.116244, "lat": 38.480215, "count": 91},
                        {"lng": 106.119292, "lat": 38.475908, "count": 54},
                        {"lng": 106.122116, "lat": 38.479658, "count": 21},
                        {"lng": 106.118322, "lat": 38.485015, "count": 15},
                        {"lng": 106.121969, "lat": 38.473527, "count": 3},
                        {"lng": 106.122936, "lat": 38.481854, "count": 24},
                        {"lng": 106.119052, "lat": 38.489217, "count": 12},
                        {"lng": 106.124579, "lat": 38.474987, "count": 57},
                        {"lng": 106.120762, "lat": 38.475251, "count": 70},
                        {"lng": 106.125867, "lat": 38.478989, "count": 8}]
                };
                //draw heatmap
                heatmap.setData(testData);
            } else {
                alert("Your browser not support canvas, can not draw heatmap")
            }

        });


    };
</script>
</body>
</html>